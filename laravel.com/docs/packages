<!doctype html>

<html lang="en">

<head>
    <title>Laravel - The PHP Framework For Web Artisans.</title>

    <!-- meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=9,chrome=1">
    <meta name="author" content="iKreativ">
    <meta name="description" content="Laravel - The PHP framework for web artisans.">
    <meta name="keywords" content="laravel, php, framework, web, artisans, taylor otwell">

    <!-- favicon -->
    <link rel="shortcut icon" href="../favicon.png?v=2">

    <!-- we're minifying and combining all our css -->
    <link href="../assets/css/style.css" rel="stylesheet">

    <!-- grab jquery from google cdn. fall back to local if offline -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../assets/js/jquery.js"><\/script>')</script>

    <!-- prettyprint -->
    <script src="http://google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>

    <!-- load up our js -->
    <script src="../assets/js/plugins.js"></script>
    <script src="../assets/js/application.js"></script>

    <!-- fonts -->
    <script src="http://use.edgefonts.net/source-sans-pro:n3,i3,n4,i4,n6,i6,n7,i7.js"></script>
    <script src="http://use.edgefonts.net/source-code-pro.js"></script>

    <!-- some conditionals for ie -->
    <!--[if IE]><link href="assets/css/ie.css" rel="stylesheet" type="text/css" /><![endif]-->

    <!-- HTML5 elements in less than IE9, yes please! -->
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

    <!-- If less than IE8 add some JS for the webfont icons -->
    <!--[if lt IE 8]><script src="assets/js/ie_font.js"></script><![endif]-->

    <!-- asynchronous google analytics. change UA-XXXXX-X to your site's ID -->
    <script>
        var _gaq=[['_setAccount','UA-23865777-1'],['_trackPageview']];
        (function(d,t){
    		var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
        	g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
        	s.parentNode.insertBefore(g,s)
    	}(document,'script'));
    </script>
</head>

<body id="index" class="page docs">

	<!-- wrapper -->
    <div id="wrapper">

        <!-- header -->
        <header id="header" role="header">
            <div class="boxed">
                <!-- tagline -->
                <div id="tagline">
                    <h1>Documentation.</h1>
                </div>
                <!-- /tagline -->

                <!-- version -->
                <div id="version">
                    <ul class="nolist">
                                                    <li><a href="dev" title="Dev">Dev</a></li>
                            <li><a href="4-1" title="4.1">4.1</a></li>
                            <li class="current"><a href="4-0" title="4.0">4.0</a></li>
                                            </ul>
                </div>
                <!-- /version -->
            </div>
        </header>
        <!-- /header -->

        <!-- nav -->
    	<nav id="primary">
    	    <div class="boxed">
    	        <div id="logo-head">
    	           <a href="../index.html"><img src="../assets/img/logo-head.png" alt="Laravel" /></a>
    	        </div>
                <ul>
                    <li><a href="../index.html">Welcome</a></li>
                    <li class="current-item"><a href="docs" title="Documentation">Documentation</a></li>
                    <li><a href="../api/4.0" title="Laravel Framework API">API</a></li>
                    <li><a href="https://github.com/laravel/laravel" title="Github">Github</a></li>
                    <li><a href="http://laravel.io/forum" title="Laravel Forums">Forums</a></li>
                    <li><a href="http://twitter.com/laravelphp" title="Laravel on Twitter">Twitter</a></li>
                </ul>
            </div>
        </nav>
        <!-- /nav -->

        <!-- content -->
        <div id="content">

            <!-- docs -->
            <section id="documentation">
                <article class="boxed">

                    <!-- docs nav -->
                    <nav id="docs">
                        <!-- Pull table of contents -->
                        <ul>
<li>Preface

<ul>
<li><a href="introduction">Introduction</a></li>
<li><a href="quick">Quickstart</a></li>
<li><a href="contributing">Contributing</a></li>
</ul></li>
<li>Getting Started

<ul>
<li><a href="installation">Installation</a></li>
<li><a href="configuration">Configuration</a></li>
<li><a href="lifecycle">Request Lifecycle</a></li>
<li><a href="routing">Routing</a></li>
<li><a href="requests">Requests &amp; Input</a></li>
<li><a href="responses">Views &amp; Responses</a></li>
<li><a href="controllers">Controllers</a></li>
<li><a href="errors">Errors &amp; Logging</a></li>
</ul></li>
<li>Learning More

<ul>
<li><a href="cache">Cache</a></li>
<li><a href="extending">Core Extension</a></li>
<li><a href="events">Events</a></li>
<li><a href="facades">Facades</a></li>
<li><a href="html">Forms &amp; HTML</a></li>
<li><a href="helpers">Helpers</a></li>
<li><a href="ioc">IoC Container</a></li>
<li><a href="localization">Localization</a></li>
<li><a href="mail">Mail</a></li>
<li><a href="packages">Package Development</a></li>
<li><a href="pagination">Pagination</a></li>
<li><a href="queues">Queues</a></li>
<li><a href="security">Security</a></li>
<li><a href="session">Session</a></li>
<li><a href="templates">Templates</a></li>
<li><a href="testing">Unit Testing</a></li>
<li><a href="validation">Validation</a></li>
</ul></li>
<li>Database

<ul>
<li><a href="database">Basic Usage</a></li>
<li><a href="queries">Query Builder</a></li>
<li><a href="eloquent">Eloquent ORM</a></li>
<li><a href="schema">Schema Builder</a></li>
<li><a href="migrations">Migrations &amp; Seeding</a></li>
<li><a href="redis">Redis</a></li>
</ul></li>
<li>Artisan CLI

<ul>
<li><a href="artisan">Overview</a></li>
<li><a href="commands">Development</a></li>
</ul></li>
</ul>
                    </nav>
                    <!-- /docs nav -->

                    <!-- docs content -->
                    <div id="docs-content">
                        <h1>Package Development</h1>

<ul>
<li><a href="packages#introduction">Introduction</a></li>
<li><a href="packages#creating-a-package">Creating A Package</a></li>
<li><a href="packages#package-structure">Package Structure</a></li>
<li><a href="packages#service-providers">Service Providers</a></li>
<li><a href="packages#package-conventions">Package Conventions</a></li>
<li><a href="packages#development-workflow">Development Workflow</a></li>
<li><a href="packages#package-routing">Package Routing</a></li>
<li><a href="packages#package-configuration">Package Configuration</a></li>
<li><a href="packages#package-migrations">Package Migrations</a></li>
<li><a href="packages#package-assets">Package Assets</a></li>
<li><a href="packages#publishing-packages">Publishing Packages</a></li>
</ul>

<p><a name="introduction"></a></p>

<h2>Introduction</h2>

<p>Packages are the primary way of adding functionality to Laravel. Packages might be anything from a great way to work with dates like <a href="https://github.com/briannesbitt/Carbon">Carbon</a>, or an entire BDD testing framework like <a href="https://github.com/Behat/Behat">Behat</a>.</p>

<p>Of course, there are different types of packages. Some packages are stand-alone, meaning they work with any framework, not just Laravel. Both Carbon and Behat are examples of stand-alone packages. Any of these packages may be used with Laravel by simply requesting them in your <code>composer.json</code> file.</p>

<p>On the other hand, other packages are specifically intended for use with Laravel. In previous versions of Laravel, these types of packages were called "bundles". These packages may have routes, controllers, views, configuration, and migrations specifically intended to enhance a Laravel application. As no special process is needed to develop stand-alone packages, this guide primarily covers the development of those that are Laravel specific.</p>

<p>All Laravel packages are distributed via <a href="http://packagist.org">Packagist</a> and <a href="http://getcomposer.org">Composer</a>, so learning about these wonderful PHP package distribution tools is essential.</p>

<p><a name="creating-a-package"></a></p>

<h2>Creating A Package</h2>

<p>The easiest way to create a new package for use with Laravel is the <code>workbench</code> Artisan command. First, you will need to set a few options in the <code>app/config/workbench.php</code> file. In that file, you will find a <code>name</code> and <code>email</code> option. These values will be used to generate a <code>composer.json</code> file for your new package. Once you have supplied those values, you are ready to build a workbench package!</p>

<p><strong>Issuing The Workbench Artisan Command</strong></p>

<pre><code>php artisan workbench vendor/package --resources
</code></pre>

<p>The vendor name is a way to distinguish your package from other packages of the same name from different authors. For example, if I (Taylor Otwell) were to create a new package named "Zapper", the vendor name could be <code>Taylor</code> while the package name would be <code>Zapper</code>. By default, the workbench will create framework agnostic packages; however, the <code>resources</code> command tells the workbench to generate the package with Laravel specific directories such as <code>migrations</code>, <code>views</code>, <code>config</code>, etc.</p>

<p>Once the <code>workbench</code> command has been executed, your package will be available within the <code>workbench</code> directory of your Laravel installation. Next, you should register the <code>ServiceProvider</code> that was created for your package. You may register the provider by adding it to the <code>providers</code> array in the <code>app/config/app.php</code> file. This will instruct Laravel to load your package when your application starts. Service providers use a <code>[Package]ServiceProvider</code> naming convention. So, using the example above, you would add <code>Taylor\Zapper\ZapperServiceProvider</code> to the <code>providers</code> array.</p>

<p>Once the provider has been registered, you are ready to start developing your package! However, before diving in, you may wish to review the sections below to get more familiar with the package structure and development workflow.</p>

<blockquote>
  <p><strong>Note:</strong> If your service provider cannot be found, run the <code>php artisan dump-autoload</code> command from your application's root directory</p>
</blockquote>

<p><a name="package-structure"></a></p>

<h2>Package Structure</h2>

<p>When using the <code>workbench</code> command, your package will be setup with conventions that allow the package to integrate well with other parts of the Laravel framework:</p>

<p><strong>Basic Package Directory Structure</strong></p>

<pre><code>/src
    /Vendor
        /Package
            PackageServiceProvider.php
    /config
    /lang
    /migrations
    /views
/tests
/public
</code></pre>

<p>Let's explore this structure further. The <code>src/Vendor/Package</code> directory is the home of all of your package's classes, including the <code>ServiceProvider</code>. The <code>config</code>, <code>lang</code>, <code>migrations</code>, and <code>views</code> directories, as you might guess, contain the corresponding resources for your package. Packages may have any of these resources, just like "regular" applications.</p>

<p><a name="service-providers"></a></p>

<h2>Service Providers</h2>

<p>Service providers are simply bootstrap classes for packages. By default, they contain two methods: <code>boot</code> and <code>register</code>. Within these methods you may do anything you like: include a routes file, register bindings in the IoC container, attach to events, or anything else you wish to do.</p>

<p>The <code>register</code> method is called immediately when the service provider is registered, while the <code>boot</code> command is only called right before a request is routed. So, if actions in your service provider rely on another service provider already being registered, or you are overriding services bound by another provider, you should use the <code>boot</code> method.</p>

<p>When creating a package using the <code>workbench</code>, the <code>boot</code> command will already contain one action:</p>

<pre><code>$this-&gt;package('vendor/package');
</code></pre>

<p>This method allows Laravel to know how to properly load the views, configuration, and other resources for your application. In general, there should be no need for you to change this line of code, as it will setup the package using the workbench conventions.</p>

<p>By default, after registering a package, its resources will be available using the "package" half of <code>vendor/package</code>. However, you may pass a second argument into the <code>package</code> method to override this behavior. For example:</p>

<pre><code>// Passing custom namespace to package method
$this-&gt;package('vendor/package', 'custom-namespace');

// Package resources now accessed via custom-namespace
$view = View::make('custom-namespace::foo');
</code></pre>

<p>There is not a "default location" for service provider classes. You may put them anywhere you like, perhaps organizing them in a <code>Providers</code> namespace within your <code>app</code> directory. The file may be placed anywhere, as long as Composer's <a href="http://getcomposer.org/doc/01-basic-usage.md#autoloading">auto-loading facilities</a> know how to load the class.</p>

<p><a name="package-conventions"></a></p>

<h2>Package Conventions</h2>

<p>When utilizing resources from a package, such as configuration items or views, a double-colon syntax will generally be used:</p>

<p><strong>Loading A View From A Package</strong></p>

<pre><code>return View::make('package::view.name');
</code></pre>

<p><strong>Retrieving A Package Configuration Item</strong></p>

<pre><code>return Config::get('package::group.option');
</code></pre>

<blockquote>
  <p><strong>Note:</strong> If your package contains migrations, consider prefixing the migration name with your package name to avoid potential class name conflicts with other packages.</p>
</blockquote>

<p><a name="development-workflow"></a></p>

<h2>Development Workflow</h2>

<p>When developing a package, it is useful to be able to develop within the context of an application, allowing you to easily view and experiment with your templates, etc. So, to get started, install a fresh copy of the Laravel framework, then use the <code>workbench</code> command to create your package structure.</p>

<p>After the <code>workbench</code> command has created your package. You may <code>git init</code> from the <code>workbench/[vendor]/[package]</code> directory and <code>git push</code> your package straight from the workbench! This will allow you to conveniently develop the package in an application context without being bogged down by constant <code>composer update</code> commands.</p>

<p>Since your packages are in the <code>workbench</code> directory, you may be wondering how Composer knows to autoload your package's files. When the <code>workbench</code> directory exists, Laravel will intelligently scan it for packages, loading their Composer autoload files when the application starts!</p>

<p>If you need to regenerate your package's autoload files, you may use the <code>php artisan dump-autoload</code> command. This command will regenerate the autoload files for your root project, as well as any workbenches you have created.</p>

<p><strong>Running The Artisan Autoload Command</strong></p>

<pre><code>php artisan dump-autoload
</code></pre>

<p><a name="package-routing"></a></p>

<h2>Package Routing</h2>

<p>In prior versions of Laravel, a <code>handles</code> clause was used to specify which URIs a package could respond to. However, in Laravel 4, a package may respond to any URI. To load a routes file for your package, simply <code>include</code> it from within your service provider's <code>boot</code> method.</p>

<p><strong>Including A Routes File From A Service Provider</strong></p>

<pre><code>public function boot()
{
    $this-&gt;package('vendor/package');

    include __DIR__.'/../../routes.php';
}
</code></pre>

<blockquote>
  <p><strong>Note:</strong> If your package is using controllers, you will need to make sure they are properly configured in your <code>composer.json</code> file's auto-load section.</p>
</blockquote>

<p><a name="package-configuration"></a></p>

<h2>Package Configuration</h2>

<p>Some packages may require configuration files. These files should be defined in the same way as typical application configuration files. And, when using the default <code>$this-&gt;package</code> method of registering resources in your service provider, may be accessed using the usual "double-colon" syntax:</p>

<p><strong>Accessing Package Configuration Files</strong></p>

<pre><code>Config::get('package::file.option');
</code></pre>

<p>However, if your package contains a single configuration file, you may simply name the file <code>config.php</code>. When this is done, you may access the options directly, without specifying the file name:</p>

<p><strong>Accessing Single File Package Configuration</strong></p>

<pre><code>Config::get('package::option');
</code></pre>

<p>Sometimes, you may wish to register package resources such as views outside of the typical <code>$this-&gt;package</code> method. Typically, this would only be done if the resources were not in a conventional location. To register the resources manually, you may use the <code>addNamespace</code> method of the <code>View</code>, <code>Lang</code>, and <code>Config</code> classes:</p>

<p><strong>Registering A Resource Namespace Manually</strong></p>

<pre><code>View::addNamespace('package', __DIR__.'/path/to/views');
</code></pre>

<p>Once the namespace has been registered, you may use the namespace name and the "double colon" syntax to access the resources:</p>

<pre><code>return View::make('package::view.name');
</code></pre>

<p>The method signature for <code>addNamespace</code> is identical on the <code>View</code>, <code>Lang</code>, and <code>Config</code> classes.</p>

<h3>Cascading Configuration Files</h3>

<p>When other developers install your package, they may wish to override some of the configuration options. However, if they change the values in your package source code, they will be overwritten the next time Composer updates the package. Instead, the <code>config:publish</code> artisan command should be used:</p>

<p><strong>Executing The Config Publish Command</strong></p>

<pre><code>php artisan config:publish vendor/package
</code></pre>

<p>When this command is executed, the configuration files for your application will be copied to <code>app/config/packages/vendor/package</code> where they can be safely modified by the developer!</p>

<blockquote>
  <p><strong>Note:</strong> The developer may also create environment specific configuration files for your package by placing them in <code>app/config/packages/vendor/package/environment</code>.</p>
</blockquote>

<p><a name="package-migrations"></a></p>

<h2>Package Migrations</h2>

<p>You may easily create and run migrations for any of your packages. To create a migration for a package in the workbench, use the <code>--bench</code> option:</p>

<p><strong>Creating Migrations For Workbench Packages</strong></p>

<pre><code>php artisan migrate:make create_users_table --bench="vendor/package"
</code></pre>

<p><strong>Running Migrations For Workbench Packages</strong></p>

<pre><code>php artisan migrate --bench="vendor/package"
</code></pre>

<p>To run migrations for a finished package that was installed via Composer into the <code>vendor</code> directory, you may use the <code>--package</code> directive:</p>

<p><strong>Running Migrations For An Installed Package</strong></p>

<pre><code>php artisan migrate --package="vendor/package"
</code></pre>

<p><a name="package-assets"></a></p>

<h2>Package Assets</h2>

<p>Some packages may have assets such as JavaScript, CSS, and images. However, we are unable to link to assets in the <code>vendor</code> or <code>workbench</code> directories, so we need a way to move these assets into the <code>public</code> directory of our application. The <code>asset:publish</code> command will take care of this for you:</p>

<p><strong>Moving Package Assets To Public</strong></p>

<pre><code>php artisan asset:publish

php artisan asset:publish vendor/package
</code></pre>

<p>If the package is still in the <code>workbench</code>, use the <code>--bench</code> directive:</p>

<pre><code>php artisan asset:publish --bench="vendor/package"
</code></pre>

<p>This command will move the assets into the <code>public/packages</code> directory according to the vendor and package name. So, a package named <code>userscape/kudos</code> would have its assets moved to <code>public/packages/userscape/kudos</code>. Using this asset publishing convention allows you to safely code asset paths in your package's views.</p>

<p><a name="publishing-packages"></a></p>

<h2>Publishing Packages</h2>

<p>When your package is ready to publish, you should submit the package to the <a href="http://packagist.org">Packagist</a> repository. If the package is specific to Laravel, consider adding a <code>laravel</code> tag to your package's <code>composer.json</code> file.</p>

<p>Also, it is courteous and helpful to tag your releases so that developers can depend on stable versions when requesting your package in their <code>composer.json</code> files. If a stable version is not ready, consider using the <code>branch-alias</code> Composer directive.</p>

<p>Once your package has been published, feel free to continue developing it within the application context created by <code>workbench</code>. This is a great way to continue to conveniently develop the package even after it has been published.</p>

<p>Some organizations choose to host their own private repository of packages for their own developers. If you are interested in doing this, review the documentation for the <a href="http://github.com/composer/satis">Satis</a> project provided by the Composer team.</p>
                    </div>
                    <!-- /docs content -->

                </article>
    	    </section>
    	    <!-- /docs -->

        </div>
    	<!-- /content -->

        <!-- footer -->
        <footer id="foot" class="textcenter">
            <div class="boxed">

                <!-- nav -->
                <nav id="secondary">
                    <div id="logo-foot">
        	           <a href="../index.html"><img src="../assets/img/logo-foot.png" alt="Laravel" /></a>
        	        </div>
                    <ul>
                        <li><a href="../index.html">Welcome</a></li>
                        <li class="current-item"><a href="docs" title="Documentation">Documentation</a></li>
                        <li><a href="api/4.0" title="Laravel Framework API">API</a></li>
                        <li><a href="https://github.com/laravel/laravel" title="Github">Github</a></li>
                        <li><a href="http://laravel.io/forum" title="Laravel Forums">Forums</a></li>
                        <li><a href="http://twitter.com/laravelphp" title="Laravel on Twitter">Twitter</a></li>
                    </ul>
                </nav>
                <!-- /nav -->

            </div>
        </footer>
        <!-- /footer -->

        <!-- to the top -->
        <div id="top">
            <a href="packages#index" title="Back to the top">
                <i class="icon-chevron-up"></i>
            </a>
        </div>
        <!-- /to the top -->

    </div>
    <!-- /wrapper -->

    <!-- copyright -->
    <section id="copyright" class="textcenter">
        <div class="boxed">
            <div class="animated slideInLeft">Laravel is a trademark of Taylor Otwell. Copyright &copy; <a href="http://twitter.com/taylorotwell" title="Taylor Otwell" target="_blank">Taylor Otwell</a>. Website built with &hearts; <a href="http://ikreativ.com/" title="iKreativ" target="_blank">iKreativ</a>.</div>
        </div>
    </section>
    <!-- /copyright -->

</body>
</html>
